(()=>{var e={};e.id=178,e.ids=[178],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},27790:e=>{"use strict";e.exports=require("assert")},84770:e=>{"use strict";e.exports=require("crypto")},17702:e=>{"use strict";e.exports=require("events")},92048:e=>{"use strict";e.exports=require("fs")},32615:e=>{"use strict";e.exports=require("http")},35240:e=>{"use strict";e.exports=require("https")},19801:e=>{"use strict";e.exports=require("os")},55315:e=>{"use strict";e.exports=require("path")},76162:e=>{"use strict";e.exports=require("stream")},74175:e=>{"use strict";e.exports=require("tty")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},71568:e=>{"use strict";e.exports=require("zlib")},62503:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>n.a,__next_app__:()=>m,originalPathname:()=>u,pages:()=>c,routeModule:()=>x,tree:()=>d}),s(85282),s(1600),s(35866);var r=s(23191),a=s(88716),i=s(37922),n=s.n(i),l=s(95231),o={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);s.d(t,o);let d=["",{children:["profile",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,85282)),"C:\\stitchify\\src\\app\\profile\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,1600)),"C:\\stitchify\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,35866,23)),"next/dist/client/components/not-found-error"]}],c=["C:\\stitchify\\src\\app\\profile\\page.tsx"],u="/profile/page",m={require:s,loadChunk:()=>Promise.resolve()},x=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/profile/page",pathname:"/profile",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},33814:(e,t,s)=>{Promise.resolve().then(s.bind(s,37555))},37555:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>j});var r=s(10326),a=s(17577),i=s(44976),n=s(20108),l=s(10119),o=s(56929),d=s(55074),c=s(87926);let u=(0,c.Z)("ShoppingBag",[["path",{d:"M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z",key:"hou9p0"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}]]);var m=s(14269),x=s(80380);let h=(0,c.Z)("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);var p=s(44099),g=s(94001),y=s(40381),f=s(35047);let b=({children:e,redirectTo:t="/login"})=>{let{isAuthenticated:s,loading:i}=(0,g.a)(),n=(0,f.useRouter)();return((0,a.useEffect)(()=>{i||s||n.push(t)},[s,i,n,t]),i)?r.jsx("div",{className:"min-h-screen flex items-center justify-center",children:r.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-primary-600"})}):s?r.jsx(r.Fragment,{children:e}):null};var v=s(55168);function j(){let{user:e}=(0,g.a)(),t=(0,i.NL)(),[s,c]=(0,a.useState)("profile"),[f,j]=(0,a.useState)(!1),[N,w]=(0,a.useState)({username:e?.username||"",email:e?.email||""}),{data:P,isLoading:q}=(0,n.a)({queryKey:["userProfile"],queryFn:async()=>(await p.Z.get("/api/users/profile")).data}),{data:M,isLoading:Z}=(0,n.a)({queryKey:["userFavorites"],queryFn:async()=>(await p.Z.get("/api/users/favorites")).data}),{data:k,isLoading:C}=(0,n.a)({queryKey:["userPurchases"],queryFn:async()=>(await p.Z.get("/api/users/purchases")).data}),S=(0,l.D)({mutationFn:async e=>(await p.Z.put("/api/users/profile",e)).data,onSuccess:e=>{j(!1),t.invalidateQueries({queryKey:["userProfile"]}),y.ZP.success("Profile updated successfully")},onError:e=>{y.ZP.error(e.response?.data?.message||"Failed to update profile")}}),_=[{id:"profile",label:"Profile",icon:o.Z},{id:"favorites",label:"Favorites",icon:d.Z},{id:"purchases",label:"Purchases",icon:u}];return r.jsx(b,{children:r.jsx("div",{className:"min-h-screen bg-gray-50",children:(0,r.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,r.jsxs)("div",{className:"mb-8",children:[r.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"My Profile"}),r.jsx("p",{className:"text-gray-600",children:"Manage your account, favorites, and purchases"})]}),r.jsx("div",{className:"border-b border-gray-200 mb-8",children:r.jsx("nav",{className:"flex space-x-8",children:_.map(e=>{let t=e.icon;return(0,r.jsxs)("button",{onClick:()=>c(e.id),className:`flex items-center space-x-2 py-4 px-1 border-b-2 font-medium text-sm transition-colors ${s===e.id?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[r.jsx(t,{className:"w-5 h-5"}),r.jsx("span",{children:e.label})]},e.id)})})}),(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow",children:["profile"===s&&(0,r.jsxs)("div",{className:"p-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[r.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Profile Information"}),!f&&(0,r.jsxs)("button",{onClick:()=>j(!0),className:"flex items-center space-x-2 px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors",children:[r.jsx(m.Z,{className:"w-4 h-4"}),r.jsx("span",{children:"Edit Profile"})]})]}),q?r.jsx("div",{className:"flex justify-center py-8",children:r.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"})}):(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Username"}),f?r.jsx("input",{type:"text",value:N.username,onChange:e=>w(t=>({...t,username:e.target.value})),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent"}):r.jsx("p",{className:"text-gray-900",children:P?.username})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email"}),f?r.jsx("input",{type:"email",value:N.email,onChange:e=>w(t=>({...t,email:e.target.value})),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent"}):r.jsx("p",{className:"text-gray-900",children:P?.email})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Role"}),r.jsx("p",{className:"text-gray-900 capitalize",children:P?.role})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Member Since"}),r.jsx("p",{className:"text-gray-900",children:P?.createdAt?new Date(P.createdAt).toLocaleDateString():"N/A"})]})]}),f&&(0,r.jsxs)("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-200",children:[(0,r.jsxs)("button",{onClick:()=>{w({username:e?.username||"",email:e?.email||""}),j(!1)},className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 transition-colors flex items-center space-x-2",children:[r.jsx(x.Z,{className:"w-4 h-4"}),r.jsx("span",{children:"Cancel"})]}),(0,r.jsxs)("button",{onClick:()=>{N.username.trim()&&N.email.trim()?S.mutate(N):y.ZP.error("Please fill in all fields")},className:"px-4 py-2 bg-primary-600 text-white rounded-md hover:bg-primary-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center space-x-2",children:[r.jsx(h,{className:"w-4 h-4"}),r.jsx("span",{children:"save changes"})]})]})]})]}),"favorites"===s&&(0,r.jsxs)("div",{className:"p-6",children:[r.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-6",children:"My Favorites"}),Z?r.jsx("div",{className:"flex justify-center py-8",children:r.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"})}):M?.length===0?(0,r.jsxs)("div",{className:"text-center py-12",children:[r.jsx(d.Z,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),r.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No favorites yet"}),r.jsx("p",{className:"text-gray-600",children:"Start browsing designs and add them to your favorites"})]}):r.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:M?.map(e=>r.jsx(v.Z,{design:e},e._id))})]}),"purchases"===s&&(0,r.jsxs)("div",{className:"p-6",children:[r.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-6",children:"Purchase History"}),C?r.jsx("div",{className:"flex justify-center py-8",children:r.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"})}):k?.length===0?(0,r.jsxs)("div",{className:"text-center py-12",children:[r.jsx(u,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),r.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No purchases yet"}),r.jsx("p",{className:"text-gray-600",children:"Start shopping for embroidery designs"})]}):r.jsx("div",{className:"space-y-4",children:k?.map(e=>r.jsxs("div",{className:"flex items-center space-x-4 p-4 border border-gray-200 rounded-lg hover:shadow-md transition-shadow",children:[r.jsx("div",{className:"flex-shrink-0",children:e.design.images&&e.design.images[0]?r.jsx("img",{src:e.design.images[0].url,alt:e.design.title,className:"w-16 h-16 object-cover rounded-lg"}):r.jsx("div",{className:"w-16 h-16 bg-gray-200 rounded-lg flex items-center justify-center",children:r.jsx("span",{className:"text-gray-500 text-xs",children:"No Image"})})}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsx("h3",{className:"text-lg font-medium text-gray-900 truncate",children:e.design.title}),r.jsxs("p",{className:"text-sm text-gray-500",children:["Purchased on ",new Date(e.createdAt).toLocaleDateString()]}),r.jsxs("p",{className:"text-sm text-gray-500",children:["Payment: ",e.paymentMethod," â€¢ $",e.amount.toFixed(2)]})]}),r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${"completed"===e.status?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:e.status}),"completed"===e.status&&r.jsx("button",{className:"px-3 py-1 bg-primary-600 text-white text-sm rounded-md hover:bg-primary-700 transition-colors",children:"Download"})]})]},e._id))})]})]})]})})})}},55168:(e,t,s)=>{"use strict";s.d(t,{Z:()=>m});var r=s(10326);s(17577);var a=s(90434),i=s(55074),n=s(75901),l=s(94001),o=s(44976),d=s(10119),c=s(44099),u=s(40381);function m({design:e}){let{isAuthenticated:t,user:s,updateFavorites:m}=(0,l.a)(),x=(0,o.NL)(),h=(0,d.D)({mutationFn:async()=>(await c.Z.post(`/api/designs/${e._id}/favorite`)).data,onSuccess:t=>{m(e._id,t.favorited),x.invalidateQueries({queryKey:["featuredDesigns"]}),x.invalidateQueries({queryKey:["popularDesigns"]}),x.invalidateQueries({queryKey:["designs"]})},onError:e=>{u.ZP.error(e.response?.data?.message||"Failed to update favorite")}}),p=s?.favorites?.includes(e._id);return(0,r.jsxs)(a.default,{href:`/designs/${e._id}`,className:"group block bg-white rounded-xl shadow-sm overflow-hidden hover:shadow-md transition-all duration-200 hover:-translate-y-0.5 border border-gray-100",children:[(0,r.jsxs)("div",{className:"relative aspect-[4/3] overflow-hidden",children:[e.images&&e.images[0]?(0,r.jsxs)(r.Fragment,{children:[r.jsx("img",{src:e.images[0].url,alt:e.images[0].alt||e.title,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-300"}),e.images.length>1&&(0,r.jsxs)("div",{className:"absolute bottom-2 right-2 bg-black/70 text-white text-xs px-2 py-1 rounded-md font-medium",children:["+",e.images.length-1]})]}):r.jsx("div",{className:"w-full h-full bg-gradient-to-br from-gray-100 to-gray-200 flex items-center justify-center",children:r.jsx("span",{className:"text-gray-400 text-sm",children:"No Image"})}),r.jsx("button",{onClick:e=>{if(e.preventDefault(),!t){u.ZP.error("Please login to add favorites");return}h.mutate()},className:`absolute top-2 right-2 p-1.5 rounded-full transition-all duration-200 ${p?"bg-red-500 text-white hover:bg-red-600 shadow-lg":"bg-white/90 text-gray-600 hover:bg-white hover:text-red-500 shadow-sm"}`,children:r.jsx(i.Z,{className:`w-3.5 h-3.5 ${p?"fill-current":""}`})}),r.jsx("div",{className:"absolute top-2 left-2",children:r.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-md ${"Beginner"===e.difficulty?"bg-green-100 text-green-700":"Intermediate"===e.difficulty?"bg-yellow-100 text-yellow-700":"bg-red-100 text-red-700"}`,children:e.difficulty})})]}),(0,r.jsxs)("div",{className:"p-3",children:[r.jsx("h3",{className:"font-medium text-gray-900 mb-2 line-clamp-2 group-hover:text-blue-600 transition-colors text-sm",children:e.title}),(0,r.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,r.jsxs)("span",{className:"text-lg font-bold text-gray-900",children:["$",e.price.toFixed(2)]}),(0,r.jsxs)("div",{className:"flex items-center space-x-1",children:[r.jsx(n.Z,{className:"w-3.5 h-3.5 text-yellow-400 fill-current"}),r.jsx("span",{className:"text-xs text-gray-600",children:e.rating?.average?.toFixed(1)||"0.0"})]})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between text-xs text-gray-500 mb-2",children:[(0,r.jsxs)("span",{children:[e.stitchCount||"N/A"," stitches"]}),(0,r.jsxs)("span",{children:[e.downloads||0," downloads"]})]}),e.categories&&e.categories.length>0&&r.jsx("div",{className:"flex flex-wrap gap-1",children:e.categories.slice(0,2).map(e=>r.jsx("span",{className:"px-2 py-1 text-xs bg-gray-100 text-gray-700 rounded-md",children:e.name},e._id))})]})]})}},85282:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});let r=(0,s(68570).createProxy)(String.raw`C:\stitchify\src\app\profile\page.tsx#default`)},10119:(e,t,s)=>{"use strict";s.d(t,{D:()=>c});var r=s(17577),a=s(71180),i=s(12113),n=s(64351),l=s(3341),o=class extends n.l{#e;#t=void 0;#s;#r;constructor(e,t){super(),this.#e=e,this.setOptions(t),this.bindMethods(),this.#a()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(e){let t=this.options;this.options=this.#e.defaultMutationOptions(e),(0,l.VS)(this.options,t)||this.#e.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#s,observer:this}),t?.mutationKey&&this.options.mutationKey&&(0,l.Ym)(t.mutationKey)!==(0,l.Ym)(this.options.mutationKey)?this.reset():this.#s?.state.status==="pending"&&this.#s.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#s?.removeObserver(this)}onMutationUpdate(e){this.#a(),this.#i(e)}getCurrentResult(){return this.#t}reset(){this.#s?.removeObserver(this),this.#s=void 0,this.#a(),this.#i()}mutate(e,t){return this.#r=t,this.#s?.removeObserver(this),this.#s=this.#e.getMutationCache().build(this.#e,this.options),this.#s.addObserver(this),this.#s.execute(e)}#a(){let e=this.#s?.state??(0,a.R)();this.#t={...e,isPending:"pending"===e.status,isSuccess:"success"===e.status,isError:"error"===e.status,isIdle:"idle"===e.status,mutate:this.mutate,reset:this.reset}}#i(e){i.Vr.batch(()=>{if(this.#r&&this.hasListeners()){let t=this.#t.variables,s=this.#t.context;e?.type==="success"?(this.#r.onSuccess?.(e.data,t,s),this.#r.onSettled?.(e.data,null,t,s)):e?.type==="error"&&(this.#r.onError?.(e.error,t,s),this.#r.onSettled?.(void 0,e.error,t,s))}this.listeners.forEach(e=>{e(this.#t)})})}},d=s(44976);function c(e,t){let s=(0,d.NL)(t),[a]=r.useState(()=>new o(s,e));r.useEffect(()=>{a.setOptions(e)},[a,e]);let n=r.useSyncExternalStore(r.useCallback(e=>a.subscribe(i.Vr.batchCalls(e)),[a]),()=>a.getCurrentResult(),()=>a.getCurrentResult()),c=r.useCallback((e,t)=>{a.mutate(e,t).catch(l.ZT)},[a]);if(n.error&&(0,l.L3)(a.options.throwOnError,[n.error]))throw n.error;return{...n,mutate:c,mutateAsync:n.mutate}}},14269:(e,t,s)=>{"use strict";s.d(t,{Z:()=>r});let r=(0,s(87926).Z)("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]])},75901:(e,t,s)=>{"use strict";s.d(t,{Z:()=>r});let r=(0,s(87926).Z)("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]])}};var t=require("../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[276,814,108,662],()=>s(62503));module.exports=r})();