"use strict";(()=>{var e={};e.id=546,e.ids=[546],e.modules={11185:e=>{e.exports=require("mongoose")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},35567:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>f,patchFetch:()=>v,requestAsyncStorage:()=>c,routeModule:()=>m,serverHooks:()=>y,staticGenerationAsyncStorage:()=>g});var n={};t.r(n),t.d(n,{GET:()=>d,dynamic:()=>l});var i=t(49303),o=t(88716),a=t(60670),s=t(87070),p=t(75748),u=t(61563);let l="force-dynamic";async function d(e){try{await (0,p.u)();let{searchParams:r}=new URL(e.url),t=parseInt(r.get("limit")||"8"),n=await u.Z.find({popular:!0}).populate("categories","name slug").sort({sales:-1,downloads:-1,rating:-1}).limit(t).lean();return s.NextResponse.json(n)}catch(e){return console.error("Get popular designs error:",e),s.NextResponse.json({message:"Server error"},{status:500})}}let m=new i.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/designs/popular/route",pathname:"/api/designs/popular",filename:"route",bundlePath:"app/api/designs/popular/route"},resolvedPagePath:"C:\\stitchify\\src\\app\\api\\designs\\popular\\route.ts",nextConfigOutput:"",userland:n}),{requestAsyncStorage:c,staticGenerationAsyncStorage:g,serverHooks:y}=m,f="/api/designs/popular/route";function v(){return(0,a.patchFetch)({serverHooks:y,staticGenerationAsyncStorage:g})}},75748:(e,r,t)=>{t.d(r,{u:()=>s});var n=t(11185),i=t.n(n);if(!process.env.MONGODB_URI)throw Error("Please define the MONGODB_URI environment variable inside .env.local");let o=process.env.MONGODB_URI,a=global.mongoose;async function s(){if(a.conn)return a.conn;a.promise||(a.promise=i().connect(o,{bufferCommands:!1}).then(e=>e));try{a.conn=await a.promise}catch(e){throw a.promise=null,e}return a.conn}a||(a=global.mongoose={conn:null,promise:null})},61563:(e,r,t)=>{t.d(r,{Z:()=>a});var n=t(11185),i=t.n(n);let o=new n.Schema({title:{type:String,required:!0,trim:!0},description:{type:String,required:!0},price:{type:Number,required:!0,min:0},images:[{url:{type:String,required:!0},alt:{type:String,required:!0}}],designFiles:{type:Map,of:String},categories:[{type:n.Schema.Types.ObjectId,ref:"Category",required:!0}],difficulty:{type:String,enum:["Beginner","Intermediate","Advanced"],default:"Beginner"},stitchCount:{type:Number,min:0},downloads:{type:Number,default:0},rating:{average:{type:Number,default:0,min:0,max:5},count:{type:Number,default:0}},sales:{type:Number,default:0},featured:{type:Boolean,default:!1},popular:{type:Boolean,default:!1},formats:[{type:String,enum:["SVG","PNG","DST","PES","JEF","EXP","HUS","VP3"]}],tags:[{type:String,trim:!0}]},{timestamps:!0}),a=i().models.Design||i().model("Design",o)}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),n=r.X(0,[276,972],()=>t(35567));module.exports=n})();