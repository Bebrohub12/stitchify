"use strict";(()=>{var e={};e.id=782,e.ids=[782],e.modules={11185:e=>{e.exports=require("mongoose")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},17233:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>y,patchFetch:()=>h,requestAsyncStorage:()=>g,routeModule:()=>c,serverHooks:()=>f,staticGenerationAsyncStorage:()=>m});var n={};r.r(n),r.d(n,{GET:()=>d,dynamic:()=>l});var i=r(49303),o=r(88716),a=r(60670),s=r(87070),p=r(75748),u=r(61563);let l="force-dynamic";async function d(e){try{await (0,p.u)();let{searchParams:t}=new URL(e.url),r=t.get("search"),n=t.get("category"),i=t.get("difficulty"),o=t.get("priceRange"),a=t.get("sortBy")||"createdAt",l=t.get("sortOrder")||"desc",d=parseInt(t.get("limit")||"20"),c=parseInt(t.get("page")||"1"),g={};if(r&&(g.$or=[{title:{$regex:r,$options:"i"}},{description:{$regex:r,$options:"i"}},{tags:{$in:[RegExp(r,"i")]}}]),n&&(g.categories=n),i&&(g.difficulty=i),o){let[e,t]=o.split("-").map(Number);t?g.price={$gte:e,$lte:t}:g.price={$gte:e}}let m={};m[a]="asc"===l?1:-1;let f=await u.Z.find(g).populate("categories","name slug").sort(m).limit(d).skip((c-1)*d).lean(),y=await u.Z.countDocuments(g);return s.NextResponse.json({designs:f,pagination:{page:c,limit:d,total:y,pages:Math.ceil(y/d)}})}catch(e){return console.error("Get designs error:",e),s.NextResponse.json({message:"Server error",error:e instanceof Error?e.message:"Unknown error",error1:e},{status:500})}}let c=new i.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/designs/route",pathname:"/api/designs",filename:"route",bundlePath:"app/api/designs/route"},resolvedPagePath:"C:\\stitchify\\src\\app\\api\\designs\\route.ts",nextConfigOutput:"",userland:n}),{requestAsyncStorage:g,staticGenerationAsyncStorage:m,serverHooks:f}=c,y="/api/designs/route";function h(){return(0,a.patchFetch)({serverHooks:f,staticGenerationAsyncStorage:m})}},75748:(e,t,r)=>{r.d(t,{u:()=>s});var n=r(11185),i=r.n(n);if(!process.env.MONGODB_URI)throw Error("Please define the MONGODB_URI environment variable inside .env.local");let o=process.env.MONGODB_URI,a=global.mongoose;async function s(){if(a.conn)return a.conn;a.promise||(a.promise=i().connect(o,{bufferCommands:!1}).then(e=>e));try{a.conn=await a.promise}catch(e){throw a.promise=null,e}return a.conn}a||(a=global.mongoose={conn:null,promise:null})},61563:(e,t,r)=>{r.d(t,{Z:()=>a});var n=r(11185),i=r.n(n);let o=new n.Schema({title:{type:String,required:!0,trim:!0},description:{type:String,required:!0},price:{type:Number,required:!0,min:0},images:[{url:{type:String,required:!0},alt:{type:String,required:!0}}],designFiles:{type:Map,of:String},categories:[{type:n.Schema.Types.ObjectId,ref:"Category",required:!0}],difficulty:{type:String,enum:["Beginner","Intermediate","Advanced"],default:"Beginner"},stitchCount:{type:Number,min:0},downloads:{type:Number,default:0},rating:{average:{type:Number,default:0,min:0,max:5},count:{type:Number,default:0}},sales:{type:Number,default:0},featured:{type:Boolean,default:!1},popular:{type:Boolean,default:!1},formats:[{type:String,enum:["SVG","PNG","DST","PES","JEF","EXP","HUS","VP3"]}],tags:[{type:String,trim:!0}]},{timestamps:!0}),a=i().models.Design||i().model("Design",o)}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),n=t.X(0,[276,972],()=>r(17233));module.exports=n})();