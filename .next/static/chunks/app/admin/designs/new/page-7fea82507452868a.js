(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[914],{7250:function(e,s,t){Promise.resolve().then(t.bind(t,3975))},3975:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return b}});var r=t(5583),a=t(1780),i=t(7437),l=t(2265),c=t(9501),n=t(9376),d=t(1713),o=t(1770),m=t(6367),u=t(3922),x=t(3739),p=t(3464),g=t(7648),h=t(9064),f=t(6908);function b(){let e=(0,n.useRouter)(),[s,t]=(0,l.useState)(!1),[b,y]=(0,l.useState)([]),[j,N]=(0,l.useState)([]),[v,w]=(0,l.useState)({}),[_,C]=(0,l.useState)([]),{register:k,handleSubmit:F,formState:{errors:S},setValue:P,watch:E}=(0,c.cI)({defaultValues:{difficulty:"Beginner",formats:[],categories:[],price:0,stitchCount:0}}),{data:Z}=(0,d.a)({queryKey:["adminCategories"],queryFn:async()=>(await p.Z.get("/api/admin/categories")).data}),q=e=>{let s=[...b],t=[...j];URL.revokeObjectURL(t[e]),s.splice(e,1),t.splice(e,1),y(s),N(t)},D=(e,s)=>{if(!s.target.files||0===s.target.files.length)return;let t=s.target.files[0];w(s=>(0,a._)((0,r._)({},s),{[e]:t})),s.target.value=""},I=e=>{w(s=>(0,a._)((0,r._)({},s),{[e]:null}))},O=(e,s)=>{s?C(s=>[...s,e]):(C(s=>s.filter(s=>s!==e)),w(s=>(0,a._)((0,r._)({},s),{[e]:null})))},R=(0,o.D)({mutationFn:async e=>(await p.Z.post("/api/admin/designs",e)).data,onSuccess:()=>{h.ZP.success("Design created successfully!"),e.push("/admin")},onError:e=>{var s,r;h.ZP.error((null===(r=e.response)||void 0===r?void 0:null===(s=r.data)||void 0===s?void 0:s.message)||"Failed to create design"),t(!1)}}),U=async e=>{t(!0);let s=new FormData;s.append("title",e.title),s.append("description",e.description),s.append("price",e.price.toString()),s.append("difficulty",e.difficulty),s.append("stitchCount",e.stitchCount.toString()),e.categories.forEach(e=>{s.append("categories",e)}),_.forEach(e=>{s.append("formats",e)}),e.tags.split(",").map(e=>e.trim()).forEach(e=>{e&&s.append("tags",e)}),b.forEach(e=>{s.append("images",e)}),Object.entries(v).forEach(e=>{let[t,r]=e;r&&s.append("designFiles[".concat(t,"]"),r)}),R.mutate(s)};return(0,i.jsx)(f.Z,{children:(0,i.jsx)("div",{className:"min-h-screen bg-gray-50 py-8",children:(0,i.jsxs)("div",{className:"max-w-5xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,i.jsx)("div",{className:"mb-8",children:(0,i.jsx)("div",{className:"flex items-center justify-between",children:(0,i.jsxs)("div",{className:"flex items-center",children:[(0,i.jsx)(g.default,{href:"/admin",className:"mr-4 p-2 rounded-full hover:bg-gray-200 transition-colors",children:(0,i.jsx)(m.Z,{className:"w-5 h-5 text-gray-600"})}),(0,i.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Add New Design"})]})})}),(0,i.jsx)("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:(0,i.jsxs)("form",{onSubmit:F(U),className:"p-6 space-y-8",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"Basic Information"}),(0,i.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,i.jsxs)("div",{className:"col-span-2",children:[(0,i.jsx)("label",{htmlFor:"title",className:"block text-sm font-medium text-gray-700 mb-1",children:"Title *"}),(0,i.jsx)("input",(0,a._)((0,r._)({id:"title",type:"text"},k("title",{required:"Title is required"})),{className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent"})),S.title&&(0,i.jsx)("p",{className:"mt-1 text-sm text-red-600",children:S.title.message})]}),(0,i.jsxs)("div",{className:"col-span-2",children:[(0,i.jsx)("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700 mb-1",children:"Description *"}),(0,i.jsx)("textarea",(0,a._)((0,r._)({id:"description",rows:4},k("description",{required:"Description is required"})),{className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent"})),S.description&&(0,i.jsx)("p",{className:"mt-1 text-sm text-red-600",children:S.description.message})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"price",className:"block text-sm font-medium text-gray-700 mb-1",children:"Price ($) *"}),(0,i.jsx)("input",(0,a._)((0,r._)({id:"price",type:"number",step:"0.01",min:"0"},k("price",{required:"Price is required",min:{value:0,message:"Price must be positive"}})),{className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent"})),S.price&&(0,i.jsx)("p",{className:"mt-1 text-sm text-red-600",children:S.price.message})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"difficulty",className:"block text-sm font-medium text-gray-700 mb-1",children:"Difficulty"}),(0,i.jsxs)("select",(0,a._)((0,r._)({id:"difficulty"},k("difficulty")),{className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[(0,i.jsx)("option",{value:"Beginner",children:"Beginner"}),(0,i.jsx)("option",{value:"Intermediate",children:"Intermediate"}),(0,i.jsx)("option",{value:"Advanced",children:"Advanced"})]}))]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"stitchCount",className:"block text-sm font-medium text-gray-700 mb-1",children:"Stitch Count"}),(0,i.jsx)("input",(0,a._)((0,r._)({id:"stitchCount",type:"number",min:"0"},k("stitchCount",{min:{value:0,message:"Stitch count must be positive"}})),{className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent"})),S.stitchCount&&(0,i.jsx)("p",{className:"mt-1 text-sm text-red-600",children:S.stitchCount.message})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"tags",className:"block text-sm font-medium text-gray-700 mb-1",children:"Tags (comma separated)"}),(0,i.jsx)("input",(0,a._)((0,r._)({id:"tags",type:"text",placeholder:"floral, spring, nature"},k("tags")),{className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent"}))]})]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"Categories"}),(0,i.jsx)("div",{className:"space-y-4",children:null==Z?void 0:Z.map(e=>(0,i.jsxs)("div",{className:"flex items-start",children:[(0,i.jsx)("input",(0,a._)((0,r._)({type:"checkbox",id:"category-".concat(e._id),value:e._id},k("categories")),{className:"mt-1 h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded"})),(0,i.jsxs)("label",{htmlFor:"category-".concat(e._id),className:"ml-3 block text-sm font-medium text-gray-700",children:[e.name,(0,i.jsx)("p",{className:"text-xs text-gray-500",children:e.description})]})]},e._id))})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"Available Formats"}),(0,i.jsx)("div",{className:"space-y-4",children:["SVG","PNG","DST","PES","JEF","EXP","HUS","VP3"].map(e=>{var s;return(0,i.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4",children:[(0,i.jsxs)("div",{className:"flex items-center mb-3",children:[(0,i.jsx)("input",{type:"checkbox",id:"format-".concat(e),value:e,checked:_.includes(e),onChange:s=>O(e,s.target.checked),className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded"}),(0,i.jsx)("label",{htmlFor:"format-".concat(e),className:"ml-3 block text-sm font-medium text-gray-700",children:e})]}),_.includes(e)&&(0,i.jsxs)("div",{className:"ml-7",children:[(0,i.jsx)("div",{className:"flex items-center justify-center w-full",children:(0,i.jsxs)("label",{htmlFor:"file-upload-".concat(e),className:"flex flex-col items-center justify-center w-full h-20 border-2 border-gray-300 border-dashed rounded-lg cursor-pointer bg-gray-50 hover:bg-gray-100",children:[(0,i.jsxs)("div",{className:"flex flex-col items-center justify-center",children:[(0,i.jsx)(u.Z,{className:"w-5 h-5 text-gray-400 mb-1"}),(0,i.jsxs)("p",{className:"text-xs text-gray-600",children:["Upload ",e," file"]})]}),(0,i.jsx)("input",{id:"file-upload-".concat(e),type:"file",accept:".".concat(e.toLowerCase()),onChange:s=>D(e,s),className:"hidden"},"file-upload-".concat(e,"-").concat(_.includes(e)))]})}),v[e]&&(0,i.jsxs)("div",{className:"mt-2 flex items-center justify-between bg-green-50 border border-green-200 rounded-md p-2",children:[(0,i.jsxs)("div",{className:"flex items-center",children:[(0,i.jsx)("div",{className:"w-2 h-2 bg-green-400 rounded-full mr-2"}),(0,i.jsx)("span",{className:"text-sm text-green-800 font-medium",children:null===(s=v[e])||void 0===s?void 0:s.name})]}),(0,i.jsx)("button",{type:"button",onClick:()=>I(e),className:"text-red-500 hover:text-red-700 p-1",children:(0,i.jsx)(x.Z,{className:"w-4 h-4"})})]})]})]},e)})})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"Images"}),(0,i.jsxs)("div",{className:"space-y-4",children:[(0,i.jsx)("div",{className:"flex items-center justify-center w-full",children:(0,i.jsxs)("label",{htmlFor:"image-upload",className:"flex flex-col items-center justify-center w-full h-32 border-2 border-gray-300 border-dashed rounded-lg cursor-pointer bg-gray-50 hover:bg-gray-100",children:[(0,i.jsxs)("div",{className:"flex flex-col items-center justify-center pt-5 pb-6",children:[(0,i.jsx)(u.Z,{className:"w-8 h-8 text-gray-400 mb-2"}),(0,i.jsx)("p",{className:"text-sm text-gray-600",children:"Click to upload images"}),(0,i.jsx)("p",{className:"text-xs text-gray-500",children:"PNG, JPG, GIF up to 10MB"})]}),(0,i.jsx)("input",{id:"image-upload",type:"file",accept:"image/*",multiple:!0,onChange:e=>{if(!e.target.files||0===e.target.files.length)return;let s=Array.from(e.target.files);if(b.length+s.length>4){h.ZP.error("Maximum 4 images allowed");return}let t=s.map(e=>URL.createObjectURL(e));y(e=>[...e,...s]),N(e=>[...e,...t]),e.target.value=""},className:"hidden"},"image-upload-".concat(b.length))]})}),j.length>0&&(0,i.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4 mt-4",children:j.map((e,s)=>(0,i.jsxs)("div",{className:"relative group",children:[(0,i.jsx)("img",{src:e,alt:"Preview ".concat(s+1),className:"h-24 w-full object-cover rounded-lg"}),(0,i.jsx)("button",{type:"button",onClick:()=>q(s),className:"absolute top-1 right-1 bg-red-500 text-white rounded-full p-1 opacity-0 group-hover:opacity-100 transition-opacity",children:(0,i.jsx)(x.Z,{className:"w-4 h-4"})})]},s))})]})]}),(0,i.jsxs)("div",{className:"pt-4 border-t border-gray-200",children:[(0,i.jsx)("button",{type:"submit",disabled:s||0===b.length&&Object.values(v).every(e=>!e),className:"w-full bg-primary-600 text-white py-3 px-6 rounded-lg font-semibold hover:bg-primary-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center justify-center gap-2",children:s?"Creating...":"Create Design"}),(0,i.jsx)("p",{className:"text-xs text-gray-500 mt-2 text-center",children:"* Required fields"})]})]})})]})})})}}},function(e){e.O(0,[589,64,464,763,713,501,398,971,117,744],function(){return e(e.s=7250)}),_N_E=e.O()}]);