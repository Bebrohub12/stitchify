"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[342],{916:function(t,e,s){s.d(e,{Z:function(){return h}});var i=s(7437);s(2265);var a=s(7648),r=s(1496),n=s(8055),o=s(4362),l=s(9827),u=s(1770),c=s(3464),d=s(9064);function h(t){var e,s,h;let{design:m}=t,{isAuthenticated:p,user:x,updateFavorites:f}=(0,o.a)(),y=(0,l.NL)(),g=(0,u.D)({mutationFn:async()=>(await c.Z.post("/api/designs/".concat(m._id,"/favorite"))).data,onSuccess:t=>{f(m._id,t.favorited),y.invalidateQueries({queryKey:["featuredDesigns"]}),y.invalidateQueries({queryKey:["popularDesigns"]}),y.invalidateQueries({queryKey:["designs"]})},onError:t=>{var e,s;d.ZP.error((null===(s=t.response)||void 0===s?void 0:null===(e=s.data)||void 0===e?void 0:e.message)||"Failed to update favorite")}}),v=null==x?void 0:null===(e=x.favorites)||void 0===e?void 0:e.includes(m._id);return(0,i.jsxs)(a.default,{href:"/designs/".concat(m._id),className:"group block bg-white rounded-xl shadow-sm overflow-hidden hover:shadow-md transition-all duration-200 hover:-translate-y-0.5 border border-gray-100",children:[(0,i.jsxs)("div",{className:"relative aspect-[4/3] overflow-hidden",children:[m.images&&m.images[0]?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("img",{src:m.images[0].url,alt:m.images[0].alt||m.title,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-300"}),m.images.length>1&&(0,i.jsxs)("div",{className:"absolute bottom-2 right-2 bg-black/70 text-white text-xs px-2 py-1 rounded-md font-medium",children:["+",m.images.length-1]})]}):(0,i.jsx)("div",{className:"w-full h-full bg-gradient-to-br from-gray-100 to-gray-200 flex items-center justify-center",children:(0,i.jsx)("span",{className:"text-gray-400 text-sm",children:"No Image"})}),(0,i.jsx)("button",{onClick:t=>{if(t.preventDefault(),!p){d.ZP.error("Please login to add favorites");return}g.mutate()},className:"absolute top-2 right-2 p-1.5 rounded-full transition-all duration-200 ".concat(v?"bg-red-500 text-white hover:bg-red-600 shadow-lg":"bg-white/90 text-gray-600 hover:bg-white hover:text-red-500 shadow-sm"),children:(0,i.jsx)(r.Z,{className:"w-3.5 h-3.5 ".concat(v?"fill-current":"")})}),(0,i.jsx)("div",{className:"absolute top-2 left-2",children:(0,i.jsx)("span",{className:"px-2 py-1 text-xs font-medium rounded-md ".concat("Beginner"===m.difficulty?"bg-green-100 text-green-700":"Intermediate"===m.difficulty?"bg-yellow-100 text-yellow-700":"bg-red-100 text-red-700"),children:m.difficulty})})]}),(0,i.jsxs)("div",{className:"p-3",children:[(0,i.jsx)("h3",{className:"font-medium text-gray-900 mb-2 line-clamp-2 group-hover:text-blue-600 transition-colors text-sm",children:m.title}),(0,i.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,i.jsxs)("span",{className:"text-lg font-bold text-gray-900",children:["$",m.price.toFixed(2)]}),(0,i.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,i.jsx)(n.Z,{className:"w-3.5 h-3.5 text-yellow-400 fill-current"}),(0,i.jsx)("span",{className:"text-xs text-gray-600",children:(null===(h=m.rating)||void 0===h?void 0:null===(s=h.average)||void 0===s?void 0:s.toFixed(1))||"0.0"})]})]}),(0,i.jsxs)("div",{className:"flex items-center justify-between text-xs text-gray-500 mb-2",children:[(0,i.jsxs)("span",{children:[m.stitchCount||"N/A"," stitches"]}),(0,i.jsxs)("span",{children:[m.downloads||0," downloads"]})]}),m.categories&&m.categories.length>0&&(0,i.jsx)("div",{className:"flex flex-wrap gap-1",children:m.categories.slice(0,2).map(t=>(0,i.jsx)("span",{className:"px-2 py-1 text-xs bg-gray-100 text-gray-700 rounded-md",children:t.name},t._id))})]})]})}},1218:function(t,e,s){s.d(e,{Z:function(){return h}});var i=s(7437);s(2265);var a=s(7648),r=s(1496),n=s(8055),o=s(4362),l=s(9827),u=s(1770),c=s(3464),d=s(9064);function h(t){var e,s,h;let{design:m}=t,{isAuthenticated:p,user:x,updateFavorites:f}=(0,o.a)(),y=(0,l.NL)(),g=(0,u.D)({mutationFn:async()=>(await c.Z.post("/api/designs/".concat(m._id,"/favorite"))).data,onSuccess:t=>{f(m._id,t.favorited),y.invalidateQueries({queryKey:["featuredDesigns"]}),y.invalidateQueries({queryKey:["popularDesigns"]}),y.invalidateQueries({queryKey:["designs"]})},onError:t=>{var e,s;d.ZP.error((null===(s=t.response)||void 0===s?void 0:null===(e=s.data)||void 0===e?void 0:e.message)||"Failed to update favorite")}}),v=null==x?void 0:null===(e=x.favorites)||void 0===e?void 0:e.includes(m._id);return(0,i.jsx)(a.default,{href:"/designs/".concat(m._id),className:"group block bg-white rounded-lg shadow-sm overflow-hidden hover:shadow-md transition-all duration-200 border border-gray-100",children:(0,i.jsxs)("div",{className:"flex",children:[(0,i.jsx)("div",{className:"relative w-24 h-24 flex-shrink-0 overflow-hidden",children:m.images&&m.images[0]?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("img",{src:m.images[0].url,alt:m.images[0].alt||m.title,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-300"}),m.images.length>1&&(0,i.jsxs)("div",{className:"absolute bottom-1 right-1 bg-black/70 text-white text-xs px-1 py-0.5 rounded text-[10px]",children:["+",m.images.length-1]})]}):(0,i.jsx)("div",{className:"w-full h-full bg-gradient-to-br from-gray-100 to-gray-200 flex items-center justify-center",children:(0,i.jsx)("span",{className:"text-gray-400 text-xs",children:"No Image"})})}),(0,i.jsxs)("div",{className:"flex-1 p-3 min-w-0",children:[(0,i.jsxs)("div",{className:"flex items-start justify-between mb-1",children:[(0,i.jsx)("h3",{className:"font-medium text-gray-900 group-hover:text-blue-600 transition-colors text-sm line-clamp-1 flex-1 mr-2",children:m.title}),(0,i.jsx)("button",{onClick:t=>{if(t.preventDefault(),!p){d.ZP.error("Please login to add favorites");return}g.mutate()},className:"p-1 rounded-full transition-all duration-200 flex-shrink-0 ".concat(v?"bg-red-500 text-white hover:bg-red-600":"bg-gray-100 text-gray-600 hover:bg-gray-200 hover:text-red-500"),children:(0,i.jsx)(r.Z,{className:"w-3 h-3 ".concat(v?"fill-current":"")})})]}),(0,i.jsx)("p",{className:"text-xs text-gray-600 line-clamp-2 mb-2",children:m.description}),(0,i.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,i.jsxs)("span",{className:"text-lg font-bold text-gray-900",children:["$",m.price.toFixed(2)]}),(0,i.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,i.jsx)(n.Z,{className:"w-3 h-3 text-yellow-400 fill-current"}),(0,i.jsx)("span",{className:"text-xs text-gray-600",children:(null===(h=m.rating)||void 0===h?void 0:null===(s=h.average)||void 0===s?void 0:s.toFixed(1))||"0.0"})]})]}),(0,i.jsxs)("div",{className:"flex items-center justify-between text-xs text-gray-500 mb-2",children:[(0,i.jsxs)("span",{className:"flex items-center space-x-3",children:[(0,i.jsxs)("span",{children:[m.stitchCount||"N/A"," stitches"]}),(0,i.jsxs)("span",{children:[m.downloads||0," downloads"]})]}),(0,i.jsx)("span",{className:"px-2 py-1 text-xs font-medium rounded-md ".concat("Beginner"===m.difficulty?"bg-green-100 text-green-700":"Intermediate"===m.difficulty?"bg-yellow-100 text-yellow-700":"bg-red-100 text-red-700"),children:m.difficulty})]}),m.categories&&m.categories.length>0&&(0,i.jsx)("div",{className:"flex flex-wrap gap-1",children:m.categories.slice(0,3).map(t=>(0,i.jsx)("span",{className:"px-2 py-1 text-xs bg-gray-100 text-gray-700 rounded-md",children:t.name},t._id))})]})]})})}},4362:function(t,e,s){s.d(e,{H:function(){return h},a:function(){return m}});var i=s(5583),a=s(1780),r=s(7437),n=s(2265),o=s(3464),l=s(9064);let u=(0,n.createContext)(void 0),c={user:null,token:localStorage.getItem("token"),isAuthenticated:!1,loading:!0},d=(t,e)=>{switch(e.type){case"AUTH_SUCCESS":return(0,a._)((0,i._)({},t),{user:e.payload.user,token:e.payload.token,isAuthenticated:!0,loading:!1});case"AUTH_FAIL":case"LOGOUT":return(0,a._)((0,i._)({},t),{user:null,token:null,isAuthenticated:!1,loading:!1});case"UPDATE_USER":return(0,a._)((0,i._)({},t),{user:e.payload});case"SET_LOADING":return(0,a._)((0,i._)({},t),{loading:e.payload});default:return t}},h=t=>{let{children:e}=t,[s,a]=(0,n.useReducer)(d,c);(0,n.useEffect)(()=>{s.token?o.Z.defaults.headers.common.Authorization="Bearer ".concat(s.token):delete o.Z.defaults.headers.common.Authorization},[s.token]),(0,n.useEffect)(()=>{(async()=>{if(s.token)try{let t=await o.Z.get("/api/auth/me");a({type:"AUTH_SUCCESS",payload:{user:t.data,token:s.token}})}catch(t){localStorage.removeItem("token"),a({type:"AUTH_FAIL"})}else a({type:"AUTH_FAIL"})})()},[s.token]);let h=async t=>{try{let e=await o.Z.post("/api/auth/register",t);return localStorage.setItem("token",e.data.token),a({type:"AUTH_SUCCESS",payload:e.data}),l.ZP.success("Registration successful!"),{success:!0}}catch(i){var e,s;let t=(null===(s=i.response)||void 0===s?void 0:null===(e=s.data)||void 0===e?void 0:e.message)||"Registration failed";return l.ZP.error(t),{success:!1,message:t}}},m=async t=>{try{let e=await o.Z.post("/api/auth/login",t);return localStorage.setItem("token",e.data.token),a({type:"AUTH_SUCCESS",payload:e.data}),l.ZP.success("Login successful!"),{success:!0}}catch(i){var e,s;let t=(null===(s=i.response)||void 0===s?void 0:null===(e=s.data)||void 0===e?void 0:e.message)||"Login failed";return l.ZP.error(t),{success:!1,message:t}}},p=async t=>{try{let e=await o.Z.put("/api/users/profile",t);return a({type:"UPDATE_USER",payload:e.data}),l.ZP.success("Profile updated successfully!"),{success:!0}}catch(i){var e,s;let t=(null===(s=i.response)||void 0===s?void 0:null===(e=s.data)||void 0===e?void 0:e.message)||"Profile update failed";return l.ZP.error(t),{success:!1,message:t}}},x={user:s.user,token:s.token,isAuthenticated:s.isAuthenticated,loading:s.loading,register:h,login:m,logout:()=>{localStorage.removeItem("token"),a({type:"LOGOUT"}),l.ZP.success("Logged out successfully")},updateProfile:p,updateFavorites:(t,e)=>{var r,n;if(!s.user)return;let o=(0,i._)({},s.user);e?(null===(r=o.favorites)||void 0===r?void 0:r.includes(t))||(o.favorites=[...o.favorites||[],t]):o.favorites=(null===(n=o.favorites)||void 0===n?void 0:n.filter(e=>e!==t))||[],a({type:"UPDATE_USER",payload:o})}};return(0,r.jsx)(u.Provider,{value:x,children:e})},m=()=>{let t=(0,n.useContext)(u);if(!t)throw Error("useAuth must be used within an AuthProvider");return t}},2894:function(t,e,s){s.d(e,{R:function(){return o},m:function(){return n}});var i=s(8238),a=s(7989),r=s(1255),n=class extends a.F{#t;#e;#s;constructor(t){super(),this.mutationId=t.mutationId,this.#e=t.mutationCache,this.#t=[],this.state=t.state||o(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){this.#t.includes(t)||(this.#t.push(t),this.clearGcTimeout(),this.#e.notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){this.#t=this.#t.filter(e=>e!==t),this.scheduleGc(),this.#e.notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){this.#t.length||("pending"===this.state.status?this.scheduleGc():this.#e.remove(this))}continue(){return this.#s?.continue()??this.execute(this.state.variables)}async execute(t){let e=()=>{this.#i({type:"continue"})};this.#s=(0,r.Mz)({fn:()=>this.options.mutationFn?this.options.mutationFn(t):Promise.reject(Error("No mutationFn found")),onFail:(t,e)=>{this.#i({type:"failed",failureCount:t,error:e})},onPause:()=>{this.#i({type:"pause"})},onContinue:e,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>this.#e.canRun(this)});let s="pending"===this.state.status,i=!this.#s.canStart();try{if(s)e();else{this.#i({type:"pending",variables:t,isPaused:i}),await this.#e.config.onMutate?.(t,this);let e=await this.options.onMutate?.(t);e!==this.state.context&&this.#i({type:"pending",context:e,variables:t,isPaused:i})}let a=await this.#s.start();return await this.#e.config.onSuccess?.(a,t,this.state.context,this),await this.options.onSuccess?.(a,t,this.state.context),await this.#e.config.onSettled?.(a,null,this.state.variables,this.state.context,this),await this.options.onSettled?.(a,null,t,this.state.context),this.#i({type:"success",data:a}),a}catch(e){try{throw await this.#e.config.onError?.(e,t,this.state.context,this),await this.options.onError?.(e,t,this.state.context),await this.#e.config.onSettled?.(void 0,e,this.state.variables,this.state.context,this),await this.options.onSettled?.(void 0,e,t,this.state.context),e}finally{this.#i({type:"error",error:e})}}finally{this.#e.runNext(this)}}#i(t){this.state=(e=>{switch(t.type){case"failed":return{...e,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...e,isPaused:!0};case"continue":return{...e,isPaused:!1};case"pending":return{...e,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...e,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...e,data:void 0,error:t.error,failureCount:e.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}})(this.state),i.Vr.batch(()=>{this.#t.forEach(e=>{e.onMutationUpdate(t)}),this.#e.notify({mutation:this,type:"updated",action:t})})}};function o(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}},1770:function(t,e,s){s.d(e,{D:function(){return h}});var i=s(5583),a=s(1780),r=s(2265),n=s(2894),o=s(8238),l=s(4112),u=s(5345),c=class extends l.l{#a;#r=void 0;#n;#o;constructor(t,e){super(),this.#a=t,this.setOptions(e),this.bindMethods(),this.#l()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(t){let e=this.options;this.options=this.#a.defaultMutationOptions(t),(0,u.VS)(this.options,e)||this.#a.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#n,observer:this}),e?.mutationKey&&this.options.mutationKey&&(0,u.Ym)(e.mutationKey)!==(0,u.Ym)(this.options.mutationKey)?this.reset():this.#n?.state.status==="pending"&&this.#n.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#n?.removeObserver(this)}onMutationUpdate(t){this.#l(),this.#u(t)}getCurrentResult(){return this.#r}reset(){this.#n?.removeObserver(this),this.#n=void 0,this.#l(),this.#u()}mutate(t,e){return this.#o=e,this.#n?.removeObserver(this),this.#n=this.#a.getMutationCache().build(this.#a,this.options),this.#n.addObserver(this),this.#n.execute(t)}#l(){let t=this.#n?.state??(0,n.R)();this.#r={...t,isPending:"pending"===t.status,isSuccess:"success"===t.status,isError:"error"===t.status,isIdle:"idle"===t.status,mutate:this.mutate,reset:this.reset}}#u(t){o.Vr.batch(()=>{if(this.#o&&this.hasListeners()){let e=this.#r.variables,s=this.#r.context;t?.type==="success"?(this.#o.onSuccess?.(t.data,e,s),this.#o.onSettled?.(t.data,null,e,s)):t?.type==="error"&&(this.#o.onError?.(t.error,e,s),this.#o.onSettled?.(void 0,t.error,e,s))}this.listeners.forEach(t=>{t(this.#r)})})}},d=s(9827);function h(t,e){let s=(0,d.NL)(e),[n]=r.useState(()=>new c(s,t));r.useEffect(()=>{n.setOptions(t)},[n,t]);let l=r.useSyncExternalStore(r.useCallback(t=>n.subscribe(o.Vr.batchCalls(t)),[n]),()=>n.getCurrentResult(),()=>n.getCurrentResult()),h=r.useCallback((t,e)=>{n.mutate(t,e).catch(u.ZT)},[n]);if(l.error&&(0,u.L3)(n.options.throwOnError,[l.error]))throw l.error;return(0,a._)((0,i._)({},l),{mutate:h,mutateAsync:l.mutate})}},7089:function(t,e,s){s.d(e,{Z:function(){return i}});let i=(0,s(8301).Z)("Grid",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["line",{x1:"3",x2:"21",y1:"9",y2:"9",key:"1vqk6q"}],["line",{x1:"3",x2:"21",y1:"15",y2:"15",key:"o2sbyz"}],["line",{x1:"9",x2:"9",y1:"3",y2:"21",key:"13tij5"}],["line",{x1:"15",x2:"15",y1:"3",y2:"21",key:"1hpv9i"}]])},1496:function(t,e,s){s.d(e,{Z:function(){return i}});let i=(0,s(8301).Z)("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]])},5964:function(t,e,s){s.d(e,{Z:function(){return i}});let i=(0,s(8301).Z)("List",[["line",{x1:"8",x2:"21",y1:"6",y2:"6",key:"7ey8pc"}],["line",{x1:"8",x2:"21",y1:"12",y2:"12",key:"rjfblc"}],["line",{x1:"8",x2:"21",y1:"18",y2:"18",key:"c3b1m8"}],["line",{x1:"3",x2:"3.01",y1:"6",y2:"6",key:"1g7gq3"}],["line",{x1:"3",x2:"3.01",y1:"12",y2:"12",key:"1pjlvk"}],["line",{x1:"3",x2:"3.01",y1:"18",y2:"18",key:"28t2mc"}]])},8055:function(t,e,s){s.d(e,{Z:function(){return i}});let i=(0,s(8301).Z)("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]])}}]);