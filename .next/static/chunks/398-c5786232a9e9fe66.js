"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[398],{9376:function(t,e,s){var i=s(5475);s.o(i,"useParams")&&s.d(e,{useParams:function(){return i.useParams}}),s.o(i,"useRouter")&&s.d(e,{useRouter:function(){return i.useRouter}}),s.o(i,"useSearchParams")&&s.d(e,{useSearchParams:function(){return i.useSearchParams}})},6908:function(t,e,s){var i=s(7437),r=s(2265),a=s(9376),n=s(4362);e.Z=t=>{let{children:e,redirectTo:s="/login"}=t,{isAuthenticated:o,user:u}=(0,n.a)(),c=(0,a.useRouter)();return((0,r.useEffect)(()=>{o?(null==u?void 0:u.role)!=="admin"&&c.push("/"):c.push(s)},[o,u,c,s]),o&&(null==u?void 0:u.role)==="admin")?(0,i.jsx)(i.Fragment,{children:e}):null}},4362:function(t,e,s){s.d(e,{H:function(){return d},a:function(){return p}});var i=s(5583),r=s(1780),a=s(7437),n=s(2265),o=s(3464),u=s(9064);let c=(0,n.createContext)(void 0),h={user:null,token:localStorage.getItem("token"),isAuthenticated:!1,loading:!0},l=(t,e)=>{switch(e.type){case"AUTH_SUCCESS":return(0,r._)((0,i._)({},t),{user:e.payload.user,token:e.payload.token,isAuthenticated:!0,loading:!1});case"AUTH_FAIL":case"LOGOUT":return(0,r._)((0,i._)({},t),{user:null,token:null,isAuthenticated:!1,loading:!1});case"UPDATE_USER":return(0,r._)((0,i._)({},t),{user:e.payload});case"SET_LOADING":return(0,r._)((0,i._)({},t),{loading:e.payload});default:return t}},d=t=>{let{children:e}=t,[s,r]=(0,n.useReducer)(l,h);(0,n.useEffect)(()=>{s.token?o.Z.defaults.headers.common.Authorization="Bearer ".concat(s.token):delete o.Z.defaults.headers.common.Authorization},[s.token]),(0,n.useEffect)(()=>{(async()=>{if(s.token)try{let t=await o.Z.get("/api/auth/me");r({type:"AUTH_SUCCESS",payload:{user:t.data,token:s.token}})}catch(t){localStorage.removeItem("token"),r({type:"AUTH_FAIL"})}else r({type:"AUTH_FAIL"})})()},[s.token]);let d=async t=>{try{let e=await o.Z.post("/api/auth/register",t);return localStorage.setItem("token",e.data.token),r({type:"AUTH_SUCCESS",payload:e.data}),u.ZP.success("Registration successful!"),{success:!0}}catch(i){var e,s;let t=(null===(s=i.response)||void 0===s?void 0:null===(e=s.data)||void 0===e?void 0:e.message)||"Registration failed";return u.ZP.error(t),{success:!1,message:t}}},p=async t=>{try{let e=await o.Z.post("/api/auth/login",t);return localStorage.setItem("token",e.data.token),r({type:"AUTH_SUCCESS",payload:e.data}),u.ZP.success("Login successful!"),{success:!0}}catch(i){var e,s;let t=(null===(s=i.response)||void 0===s?void 0:null===(e=s.data)||void 0===e?void 0:e.message)||"Login failed";return u.ZP.error(t),{success:!1,message:t}}},f=async t=>{try{let e=await o.Z.put("/api/users/profile",t);return r({type:"UPDATE_USER",payload:e.data}),u.ZP.success("Profile updated successfully!"),{success:!0}}catch(i){var e,s;let t=(null===(s=i.response)||void 0===s?void 0:null===(e=s.data)||void 0===e?void 0:e.message)||"Profile update failed";return u.ZP.error(t),{success:!1,message:t}}},y={user:s.user,token:s.token,isAuthenticated:s.isAuthenticated,loading:s.loading,register:d,login:p,logout:()=>{localStorage.removeItem("token"),r({type:"LOGOUT"}),u.ZP.success("Logged out successfully")},updateProfile:f,updateFavorites:(t,e)=>{var a,n;if(!s.user)return;let o=(0,i._)({},s.user);e?(null===(a=o.favorites)||void 0===a?void 0:a.includes(t))||(o.favorites=[...o.favorites||[],t]):o.favorites=(null===(n=o.favorites)||void 0===n?void 0:n.filter(e=>e!==t))||[],r({type:"UPDATE_USER",payload:o})}};return(0,a.jsx)(c.Provider,{value:y,children:e})},p=()=>{let t=(0,n.useContext)(c);if(!t)throw Error("useAuth must be used within an AuthProvider");return t}},2894:function(t,e,s){s.d(e,{R:function(){return o},m:function(){return n}});var i=s(8238),r=s(7989),a=s(1255),n=class extends r.F{#t;#e;#s;constructor(t){super(),this.mutationId=t.mutationId,this.#e=t.mutationCache,this.#t=[],this.state=t.state||o(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){this.#t.includes(t)||(this.#t.push(t),this.clearGcTimeout(),this.#e.notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){this.#t=this.#t.filter(e=>e!==t),this.scheduleGc(),this.#e.notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){this.#t.length||("pending"===this.state.status?this.scheduleGc():this.#e.remove(this))}continue(){return this.#s?.continue()??this.execute(this.state.variables)}async execute(t){let e=()=>{this.#i({type:"continue"})};this.#s=(0,a.Mz)({fn:()=>this.options.mutationFn?this.options.mutationFn(t):Promise.reject(Error("No mutationFn found")),onFail:(t,e)=>{this.#i({type:"failed",failureCount:t,error:e})},onPause:()=>{this.#i({type:"pause"})},onContinue:e,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>this.#e.canRun(this)});let s="pending"===this.state.status,i=!this.#s.canStart();try{if(s)e();else{this.#i({type:"pending",variables:t,isPaused:i}),await this.#e.config.onMutate?.(t,this);let e=await this.options.onMutate?.(t);e!==this.state.context&&this.#i({type:"pending",context:e,variables:t,isPaused:i})}let r=await this.#s.start();return await this.#e.config.onSuccess?.(r,t,this.state.context,this),await this.options.onSuccess?.(r,t,this.state.context),await this.#e.config.onSettled?.(r,null,this.state.variables,this.state.context,this),await this.options.onSettled?.(r,null,t,this.state.context),this.#i({type:"success",data:r}),r}catch(e){try{throw await this.#e.config.onError?.(e,t,this.state.context,this),await this.options.onError?.(e,t,this.state.context),await this.#e.config.onSettled?.(void 0,e,this.state.variables,this.state.context,this),await this.options.onSettled?.(void 0,e,t,this.state.context),e}finally{this.#i({type:"error",error:e})}}finally{this.#e.runNext(this)}}#i(t){this.state=(e=>{switch(t.type){case"failed":return{...e,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...e,isPaused:!0};case"continue":return{...e,isPaused:!1};case"pending":return{...e,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...e,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...e,data:void 0,error:t.error,failureCount:e.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}})(this.state),i.Vr.batch(()=>{this.#t.forEach(e=>{e.onMutationUpdate(t)}),this.#e.notify({mutation:this,type:"updated",action:t})})}};function o(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}},1770:function(t,e,s){s.d(e,{D:function(){return d}});var i=s(5583),r=s(1780),a=s(2265),n=s(2894),o=s(8238),u=s(4112),c=s(5345),h=class extends u.l{#r;#a=void 0;#n;#o;constructor(t,e){super(),this.#r=t,this.setOptions(e),this.bindMethods(),this.#u()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(t){let e=this.options;this.options=this.#r.defaultMutationOptions(t),(0,c.VS)(this.options,e)||this.#r.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#n,observer:this}),e?.mutationKey&&this.options.mutationKey&&(0,c.Ym)(e.mutationKey)!==(0,c.Ym)(this.options.mutationKey)?this.reset():this.#n?.state.status==="pending"&&this.#n.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#n?.removeObserver(this)}onMutationUpdate(t){this.#u(),this.#c(t)}getCurrentResult(){return this.#a}reset(){this.#n?.removeObserver(this),this.#n=void 0,this.#u(),this.#c()}mutate(t,e){return this.#o=e,this.#n?.removeObserver(this),this.#n=this.#r.getMutationCache().build(this.#r,this.options),this.#n.addObserver(this),this.#n.execute(t)}#u(){let t=this.#n?.state??(0,n.R)();this.#a={...t,isPending:"pending"===t.status,isSuccess:"success"===t.status,isError:"error"===t.status,isIdle:"idle"===t.status,mutate:this.mutate,reset:this.reset}}#c(t){o.Vr.batch(()=>{if(this.#o&&this.hasListeners()){let e=this.#a.variables,s=this.#a.context;t?.type==="success"?(this.#o.onSuccess?.(t.data,e,s),this.#o.onSettled?.(t.data,null,e,s)):t?.type==="error"&&(this.#o.onError?.(t.error,e,s),this.#o.onSettled?.(void 0,t.error,e,s))}this.listeners.forEach(t=>{t(this.#a)})})}},l=s(9827);function d(t,e){let s=(0,l.NL)(e),[n]=a.useState(()=>new h(s,t));a.useEffect(()=>{n.setOptions(t)},[n,t]);let u=a.useSyncExternalStore(a.useCallback(t=>n.subscribe(o.Vr.batchCalls(t)),[n]),()=>n.getCurrentResult(),()=>n.getCurrentResult()),d=a.useCallback((t,e)=>{n.mutate(t,e).catch(c.ZT)},[n]);if(u.error&&(0,c.L3)(n.options.throwOnError,[u.error]))throw u.error;return(0,r._)((0,i._)({},u),{mutate:d,mutateAsync:u.mutate})}},6367:function(t,e,s){s.d(e,{Z:function(){return i}});let i=(0,s(8301).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},3739:function(t,e,s){s.d(e,{Z:function(){return i}});let i=(0,s(8301).Z)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},3922:function(t,e,s){s.d(e,{Z:function(){return i}});let i=(0,s(8301).Z)("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]])}}]);